<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
<script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
<style>
   #div-top{
      padding-top: 100px;
   }

   li{
   float:left;
   margin-right: 20px;
   }

</style>

<script>
/** 우편번호 찾기 */
function execDaumPostcode() {
    daum.postcode.load(function(){
        new daum.Postcode({
            oncomplete: function(data) {
              // 팝업에서 검색결과 항목을 클릭했을때 실행할 코드를 작성하는 부분입니다.
              $("#upost").val(data.zonecode);
              $("#uaddr").val(data.roadAddress);
            }
        }).open();
    });
}

$(document).ready(function(){
	//전화번호 유효성 검사
	function autoHypenTel(str) {
		  str = str.replace(/[^0-9]/g, '');
		  var tmp = '';

		  if (str.substring(0, 2) == 02) {
		    // 서울 전화번호일 경우 10자리까지만 나타나고 그 이상의 자리수는 자동삭제
		    if (str.length < 3) {
		      return str;
		    } else if (str.length < 6) {
		      tmp += str.substr(0, 2);
		      tmp += '-';
		      tmp += str.substr(2);
		      return tmp;
		    } else if (str.length < 10) {
		      tmp += str.substr(0, 2);
		      tmp += '-';
		      tmp += str.substr(2, 3);
		      tmp += '-';
		      tmp += str.substr(5);
		      return tmp;
		    } else {
		      tmp += str.substr(0, 2);
		      tmp += '-';
		      tmp += str.substr(2, 4);
		      tmp += '-';
		      tmp += str.substr(6, 4);
		      return tmp;
		    }
		  } else {
		    // 핸드폰 및 다른 지역 전화번호 일 경우
		    if (str.length < 4) {
		      return str;
		    } else if (str.length < 7) {
		      tmp += str.substr(0, 3);
		      tmp += '-';
		      tmp += str.substr(3);
		      return tmp;
		    } else if (str.length < 11) {
		      tmp += str.substr(0, 3);
		      tmp += '-';
		      tmp += str.substr(3, 3);
		      tmp += '-';
		      tmp += str.substr(6);
		      return tmp;
		    } else {
		      tmp += str.substr(0, 3);
		      tmp += '-';
		      tmp += str.substr(3, 4);
		      tmp += '-';
		      tmp += str.substr(7);
		      return tmp;
		    }
		  }

		  return str;
		}
	
	$('#uphone').keyup(function (event) {
		  event = event || window.event;
		  var _val = this.value.trim();
		  this.value = autoHypenTel(_val);
		});
	
	
	//탁송비
	
	var addr = $('#uaddr').val();
	if (addr.match("제주")){
		$('#shipprice').val(100000);	
	}else if (addr = ''){
		$('#shipprice').val(0);
	}else{
		$('#shipprice').val(10000);
	};
	
	//최종가격
	var carprice = $('#carprice').val();
	var shipprice = $('#shipprice').val();
	var cp = parseInt(carprice,10);
	var sp = parseInt(shipprice,10);
	$('#finalprice').val(cp+sp);


	
	$('#registerbtn').click(function(){
		$('.form-horizontal').attr({
			'method':'post',
			'action':'registerimpl'
		});
		$('.form-horizontal').submit();
		alert("회원가입이 완료되었습니다");
	});
	
});
</script>

<div id="div-top" class="container-fluid">

    <div class="col-sm-12" >
    <h2 >주문하기</h2>
       <div class="container">
       
         <form class="form-horizontal" >
			
			<input type="hidden" class="form-control" name="mname" id="mname" readonly th:value="${garage.mname}"/>
			<input type="hidden" class="form-control" name="coloption" id="coloption" readonly th:value="${garage.coloption}"/>
			<input type="hidden" class="form-control" name="woption" id="woption" readonly th:value="${garage.woption}"/>
			<input type="hidden" class="form-control" name="ioption" id="ioption" readonly th:value="${garage.ioption}"/>
			<input type="hidden" class="form-control" name="carprice" id="carprice" readonly th:value="${garage.price}"/>

            
            
             
            <div class="form-group ship">
            	<h3>탁송 정보</h3>        
	            <div class="form-group">
	               <label class="control-label col-sm-2" for="name">Name:</label>
	                 <div class="col-sm-4">          
	                    <input type="text" class="form-control" name="uname" id="uname" th:value="${users.uname}">
	                 </div>
	             </div>
	             <div class="form-group">
	               <label class="control-label col-sm-2" for="phone">Phone Number:</label>
	                 <div class="col-sm-4">          
	                    <input type="tel" class="form-control" name="uphone" id="uphone" maxlength="13" th:value="${users.uphone}">

	                 </div>
	             </div>
				<div class="form-group">
					<label class="control-label col-sm-2" for="addr">Address:</label>
					<div class="col-sm-2">
				    	<input type="text" class="form-control" name="upost" id="upost" placeholder="우편번호" readonly th:value="${users.upost}"/>
					</div>
					<div class="col-sm-2">
				   		<button type="button" class="btn btn-info" onclick="execDaumPostcode()">우편번호 찾기</button>
					</div>
				</div>
				
				<div class="form-group">
					<label class="control-label col-sm-2" for="addr"></label>
					<div class="col-sm-4">
						<input
						  type="text"
						  class="form-control"
						  name="uaddr"
						  id="uaddr"
						  placeholder="도로명 주소"
						  readonly
						  th:value="${users.uaddr}"
						/>
					</div>
				</div>
				
				<div class="form-group">
					<label class="control-label col-sm-2" for="addr"></label>
					<div class="col-sm-4">
						<input
						  type="text"
						  class="form-control"
						  name="udaddr"
						  id="udaddr"
						  placeholder="상세 주소"
						  required
						  th:value="${users.udaddr}"
						/>
					</div>
					<span id="ppost"></span>
				</div>
			</div>
			<div class="form-group">
				<label class="control-label col-sm-2" for="mname">탁송비:</label>
				<div class="col-sm-4">
			    	<input type="number" class="form-control" name="shipprice" id="shipprice" readonly/>
			   
				</div>
			</div>
    
            <div class="form-group">
				<label class="control-label col-sm-2" for="price">최종 가격:</label>
				<div class="col-sm-4">
			    	<input type="number" class="form-control" name="finalprice" id="finalprice" readonly/>
				</div>
			</div>

			
		<h3>차견적</h3>	
		<div class="form-group">
			<div class="panel-group">
				<div class="panel panel-default" >
					<div class="panel-heading" >
						<h4 class="panel-title" >

							<a class ="pannel-detail" data-toggle="collapse" href="#collapse1" th:text="${garage.mname}">자세히 보기</a>
						</h4>   
					</div>
						<div id="collapse1" class="panel-collapse collapse">
							<div class="panel-body">
								  <ul class="list-group">
								    <li class="list-group-item">휠옵션<p th:text="${garage.coloption}"></p></li>
								    <li class="list-group-item">th:text="${garage.woption}"</li>
								    <li class="list-group-item">th:text="${garage.ioption}"</li>
								    <li class="list-group-item">th:text="${garage.woption}"</li>						 
								  </ul>
							</div>							
						</div>
					</div>
				</div>
			</div>
		</div>
		
             <div class="form-group">        
                  <div class="col-sm-offset-2 col-sm-3">
                       <a href="#" class="btn btn-info m-btn--air"  id="registerbtn">회원가입 </a>
         
                  </div>
            </div>
         </form>
         
         <div class="form-group">        
               <div class="col-sm-offset-2 col-sm-3">
                  <hr>
                
               </div>
          </div>
      </div>
      
    </div>
    <div class="col-sm-4">
   </div>  
</div>